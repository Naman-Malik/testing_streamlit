CREATE DATABASE SampleDatabase;
USE DATABASE SampleDatabase;
CREATE SCHEMA LANGUAGEUSAGE;
USE SCHEMA LANGUAGEUSAGE;
CREATE STAGE LANGUAGEUSAGE;

CREATE OR REPLACE TABLE LOCALE_USAGE(
    DATE DATE,
    LOCALE VARCHAR,
    NUM_DEVELOPERS NUMBER,
    COUNTRY VARCHAR
);

CREATE OR REPLACE TABLE COUNTRY_INFORMATION(
    COUNTRY VARCHAR,
    GEOMETRY VARCHAR
);

COPY INTO LOCALE_USAGE
FROM '@LANGUAGEUSAGE'
FILES = ('locale_usage.csv')
FILE_FORMAT = (
    TYPE = CSV
);

COPY INTO COUNTRY_INFORMATION
FROM '@LANGUAGEUSAGE'
FILES = ('country_information.csv')
FILE_FORMAT = (
    TYPE = CSV
    FIELD_OPTIONALLY_ENCLOSED_BY = '"'
);